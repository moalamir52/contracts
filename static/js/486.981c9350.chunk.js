(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var a=o.call(e,r||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}function r(t,r,o){return(r=e(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}importScripts("https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js");let a=[],n=[];const c=t=>(t||"").toString().replace(/\s+/g,"").toLowerCase();onmessage=function(t){console.log("Worker: Message received from main script");const{type:e,payload:s}=t.data;if("PROCESS_FILE"===e){const t=s;try{const e=new Uint8Array(t),c=XLSX.read(e,{type:"array"}).SheetNames[0],s=XLSX.Sheets[c],i=XLSX.utils.sheet_to_json(s,{cellDates:!0}),l=i.length,u=new Set(i.map((t=>t["Contract No."])).filter(Boolean)).size,p={},f={},m={},g=t=>(t||"").toString().replace(/\s+/g,"").toUpperCase();i.forEach((t=>{const e=t["Contract No."],r=t["Plate Number"],o=g(r),a=t["Revenue Date"],n=t["Pickup Odometer"]||"";if(!e||!o||!a)return;p[e]||(p[e]={}),p[e][o]||(p[e][o]=[]),p[e][o].push(a),f[e]||(f[e]={"Pick-up Date":t["Pick-up Date"]||"","Drop-off Date":t["Drop-off Date"]||"","Plate Number":r||"","Car Model":t["Car Model"]||"","Car Category":t["Car Category"]||"","Manufacture Year":t["Manufacture Year"]||"","Customer Name":t["Customer Name"]||"","Customer Phone":t["Customer Phone"]||""});const c=(t=>{if(t instanceof Date&&!isNaN(t)){const e=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return"".concat(e,"/").concat(r,"/").concat(o)}if("number"===typeof t){const e=Math.floor(t-25569),r=new Date(1e3*(86400*e)),o=Math.round(86400*(t-Math.floor(t))*1e3);r.setTime(r.getTime()+o);const a=String(r.getDate()).padStart(2,"0"),n=String(r.getMonth()+1).padStart(2,"0"),c=r.getFullYear();return"".concat(a,"/").concat(n,"/").concat(c)}if("string"===typeof t&&/^\d{4}-\d{2}-\d{2}/.test(t)){const e=new Date(t);if(!isNaN(e)){const t=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return"".concat(t,"/").concat(r,"/").concat(o)}}return t})(a);m[o]||(m[o]={}),m[o][c]={model:t["Car Model"]||"",category:t["Car Category"]||"",year:t["Manufacture Year"]||"",pickupOdometer:n}}));const y=[],d=[];Object.entries(p).forEach((t=>{let[e,a]=t,n=[];const c=t=>{if(t instanceof Date&&!isNaN(t)){const e=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return"".concat(e,"/").concat(r,"/").concat(o)}if("string"===typeof t&&/^\d{4}-\d{2}-\d{2}/.test(t)){const[e,r,o]=t.split("-"),[a]=o.split("T")[0].split(" ");return"".concat(a,"/").concat(r,"/").concat(e)}return t};Object.entries(a).forEach((t=>{let[e,r]=t;r.forEach((t=>{let r=t;if("number"===typeof t)r=(t=>{const e=Math.floor(t-25569),r=new Date(86400*e*1e3),o=Math.round(86400*(t-Math.floor(t))*1e3);return r.setTime(r.getTime()+o),r})(t);else if("string"===typeof t){const e=new Date(t);isNaN(e)||(r=e)}n.push({plate:e,date:r})}))})),n.sort(((t,e)=>new Date(t.date)-new Date(e.date)));let s=[],i=null,l=null,u=null,p=null;n.forEach(((t,e)=>{const{plate:r,date:o}=t;r!==i&&(null!==i&&s.push({plate:i,from:c(l),to:c(u),revenueDate:p}),l=o,p=t.date instanceof Date?t.date.toISOString():t.date),u=o,i=r,e===n.length-1&&s.push({plate:r,from:c(l),to:c(u),revenueDate:p})}));const g=s.map((t=>{let e=m[t.plate]&&m[t.plate][t.from]||{};if(!e.pickupOdometer){const r=m[t.plate];if(r){e=r[Object.keys(r)[0]]}}return"".concat(t.plate," | ").concat(e.model||"-"," | ").concat(e.category||"-"," | ").concat(e.year||"-"," | Pickup Odometer: ").concat(e.pickupOdometer||"-"," (").concat(t.from," - ").concat(t.to,")")})),S=Array.from(new Set(s.map((t=>t.plate)))),h=function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({contract:e,cars:g,carsCount:S.length},f[e]);y.push(h),S.length>1&&d.push(h)}));const S={totalRows:l,uniqueContracts:u,multiCarContracts:d.length};a=y,n=d,postMessage({type:"FILE_PROCESSED",payload:{allContractsResultRows:y,multiCarResultRows:d,stats:S}})}catch(i){console.error("Worker error:",i),postMessage({type:"ERROR",payload:i.message})}}else if("INITIALIZE_DATA"===e)a=s.allUniqueContracts,n=s.results,postMessage({type:"SEARCH_RESULTS",payload:n});else if("SEARCH_DATA"===e){const{searchTerm:t}=s,e=t.trim()?a:n;if(!t.trim())return void postMessage({type:"SEARCH_RESULTS",payload:e});const r=t.trim().toLowerCase(),o=c(r),i=e.filter((t=>!(!t.contract||!t.contract.toLowerCase().includes(r)&&!c(t.contract).includes(o))||(!(!t.cars||!t.cars.some((t=>t.toLowerCase().includes(r)||c(t).includes(o))))||(!(!t.carsCount||t.carsCount.toString()!==r)||!(!t["Customer Name"]||!t["Customer Name"].toLowerCase().includes(r)&&!c(t["Customer Name"]).includes(o))))));postMessage({type:"SEARCH_RESULTS",payload:i})}}})();
//# sourceMappingURL=486.981c9350.chunk.js.map