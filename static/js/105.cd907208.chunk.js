(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,r||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}function r(t,r,o){return(r=e(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}importScripts("https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"),onmessage=function(t){console.log("Worker: Message received from main script");const e=t.data;try{const t=new Uint8Array(e),n=XLSX.read(t,{type:"array"}),a=n.SheetNames[0],c=n.Sheets[a],s=XLSX.utils.sheet_to_json(c,{cellDates:!0}),i=s.length,l=new Set(s.map((t=>t["Contract No."])).filter(Boolean)).size,u={},p={},f={},m=t=>(t||"").toString().replace(/\s+/g,"").toUpperCase();s.forEach((t=>{const e=t["Contract No."],r=t["Plate Number"],o=m(r),n=t["Revenue Date"],a=t["Pickup Odometer"]||"";if(!e||!o||!n)return;u[e]||(u[e]={}),u[e][o]||(u[e][o]=[]),u[e][o].push(n),p[e]||(p[e]={"Pick-up Date":t["Pick-up Date"]||"","Drop-off Date":t["Drop-off Date"]||"","Plate Number":r||"","Car Model":t["Car Model"]||"","Car Category":t["Car Category"]||"","Manufacture Year":t["Manufacture Year"]||"","Customer Name":t["Customer Name"]||"","Customer Phone":t["Customer Phone"]||""});const c=(t=>{if(t instanceof Date&&!isNaN(t)){const e=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return"".concat(e,"/").concat(r,"/").concat(o)}if("number"===typeof t){const e=Math.floor(t-25569),r=new Date(1e3*(86400*e)),o=Math.round(86400*(t-Math.floor(t))*1e3);r.setTime(r.getTime()+o);const n=String(r.getDate()).padStart(2,"0"),a=String(r.getMonth()+1).padStart(2,"0"),c=r.getFullYear();return"".concat(n,"/").concat(a,"/").concat(c)}if("string"===typeof t&&/^\d{4}-\d{2}-\d{2}/.test(t)){const e=new Date(t);if(!isNaN(e)){const t=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return"".concat(t,"/").concat(r,"/").concat(o)}}return t})(n);f[o]||(f[o]={}),f[o][c]={model:t["Car Model"]||"",category:t["Car Category"]||"",year:t["Manufacture Year"]||"",pickupOdometer:a}}));const g=[],y=[];Object.entries(u).forEach((t=>{let[e,n]=t,a=[];const c=t=>{if(t instanceof Date&&!isNaN(t)){const e=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return"".concat(e,"/").concat(r,"/").concat(o)}if("string"===typeof t&&/^\d{4}-\d{2}-\d{2}/.test(t)){const[e,r,o]=t.split("-"),[n]=o.split("T")[0].split(" ");return"".concat(n,"/").concat(r,"/").concat(e)}return t};Object.entries(n).forEach((t=>{let[e,r]=t;r.forEach((t=>{let r=t;if("number"===typeof t)r=(t=>{const e=Math.floor(t-25569),r=new Date(86400*e*1e3),o=Math.round(86400*(t-Math.floor(t))*1e3);return r.setTime(r.getTime()+o),r})(t);else if("string"===typeof t){const e=new Date(t);isNaN(e)||(r=e)}a.push({plate:e,date:r})}))})),a.sort(((t,e)=>new Date(t.date)-new Date(e.date)));let s=[],i=null,l=null,u=null,m=null;a.forEach(((t,e)=>{const{plate:r,date:o}=t;r!==i&&(null!==i&&s.push({plate:i,from:c(l),to:c(u),revenueDate:m}),l=o,m=t.date instanceof Date?t.date.toISOString():t.date),u=o,i=r,e===a.length-1&&s.push({plate:r,from:c(l),to:c(u),revenueDate:m})}));const d=s.map((t=>{let e=f[t.plate]&&f[t.plate][t.from]||{};if(!e.pickupOdometer){const r=f[t.plate];if(r){e=r[Object.keys(r)[0]]}}return"".concat(t.plate," | ").concat(e.model||"-"," | ").concat(e.category||"-"," | ").concat(e.year||"-"," | Pickup Odometer: ").concat(e.pickupOdometer||"-"," (").concat(t.from," - ").concat(t.to,")")})),h=Array.from(new Set(s.map((t=>t.plate)))),b=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({contract:e,cars:d,carsCount:h.length},p[e]);g.push(b),h.length>1&&y.push(b)}));const d={totalRows:i,uniqueContracts:l,multiCarContracts:y.length};postMessage({allContractsResultRows:g,multiCarResultRows:y,stats:d})}catch(n){console.error("Worker error:",n),postMessage({error:n.message})}}})();
//# sourceMappingURL=105.cd907208.chunk.js.map