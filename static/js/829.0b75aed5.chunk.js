(()=>{"use strict";const e=e=>{if(!(e instanceof Date)||isNaN(e))return"Invalid Date";const t=String(e.getUTCDate()).padStart(2,"0"),s=String(e.getUTCMonth()+1).padStart(2,"0"),a=e.getUTCFullYear();return"".concat(t,"/").concat(s,"/").concat(a)},t=t=>{const s={},a={};t.forEach(e=>{const t=e["Contract No."],a=e["Plate Number"],r=(a||"").toString().replace(/\s+/g,"").toUpperCase();const o=e["Customer Name"]||e.Customer||e.customer||e.Name||"",c=e["Car Model"]||e.Model||e.model||e.Vehicle||"",n=(e=>{if(!e||""===e.trim())return null;const t=e.replace(/\//g,"-").split("-");if(3!==t.length){const t=new Date(e);return isNaN(t.getTime())?null:t}let[s,a,r]=t.map(e=>parseInt(e,10));if(isNaN(s)||isNaN(a)||isNaN(r)){const t=new Date(e);return isNaN(t.getTime())?null:t}r<100&&(r+=2e3);const o=new Date(Date.UTC(r,a-1,s));return isNaN(o.getTime())?null:o})(e["Revenue Date"]);t&&r&&n&&(s[t]||(s[t]={contractNo:t,customerName:o,cars:{},carsRaw:{}}),s[t].cars[r]||(s[t].cars[r]={plateNumber:r,carModel:c,dates:[]},s[t].carsRaw[r]=a),s[t].cars[r].dates.push(n))});const r=[];return Object.values(s).forEach(t=>{a[t.contractNo]=Object.keys(t.cars).length+" => ["+Object.values(t.carsRaw).join(", ")+"]";const s=Object.values(t.cars);if(s.length<=1)return;const o=s.map(t=>{const s=t.dates.sort((e,t)=>e-t);return{plateNumber:t.plateNumber,carModel:t.carModel,from:e(s[0]),to:e(s[s.length-1])}});r.push({contractNo:t.contractNo,customerName:t.customerName,carsCount:s.length,carDetails:o})}),r};let s=[];self.onmessage=e=>{const{type:a,data:r}=e.data;try{if("CHUNK"===a){if(Array.isArray(r))for(let e=0;e<r.length;e++)s.push(r[e]);self.postMessage({progress:"Processed ".concat(s.length," rows...")})}else if("DONE"===a){self.postMessage({progress:"Analyzing contracts..."});const e=t(s),a=(s.length,new Set(s.map(e=>e["Contract No."])).size),r=e.length,o={totalRows:s.length,totalContracts:a,singleCarContracts:a-r,multiCarContracts:r};self.postMessage({success:!0,results:e,summary:o}),s=[]}else"RESET"===a&&(s=[])}catch(o){console.error("Worker Error details:",o),self.postMessage({error:o.message}),s=[]}}})();
//# sourceMappingURL=829.0b75aed5.chunk.js.map